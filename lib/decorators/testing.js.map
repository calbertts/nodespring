{"version":3,"sources":["../../src/decorators/testing.js"],"names":[],"mappings":"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","file":"testing.js","sourcesContent":["import {ModuleContainer} from '../core/moduleContainer'\r\n\r\nvar injectMocksCllbk\r\nvar localMocksInjectedCllbk\r\nvar mocksToInject = {}\r\n\r\nlet isClass = (arg) => {\r\n  return arg && arg.constructor === Function\r\n}\r\n\r\nexport function TestClass(testClass) {\r\n  if(!isClass(testClass))\r\n    throw new TypeError('A class was expected to test')\r\n\r\n  let testClassObj = new testClass()\r\n  injectMocksCllbk(testClassObj)\r\n  localMocksInjectedCllbk(testClassObj)\r\n\r\n  let testingMethods = Object.getOwnPropertyNames(testClass.prototype)\r\n\r\n  // Running all methods\r\n  let beforeMethods = testingMethods.filter((method) => {return testClassObj[method].beforeMethod === true})\r\n  let testMethods = testingMethods.filter((method) => {return testClassObj[method].testMethod === true})\r\n\r\n  testMethods.forEach((method) => {\r\n    beforeMethods.forEach((beforeMethod) => {\r\n      testClassObj[beforeMethod]()\r\n    })\r\n    testClassObj[method]()\r\n  })\r\n}\r\n\r\n\r\nexport function Mock(type) {\r\n  if(!type.moduleType === 'interface')\r\n    throw new TypeError('Mock expects an Interface as a parameter, instead ' + type.name + ' was received')\r\n\r\n  return (target, property, descriptor) => {\r\n    let mockInstance = {\r\n      uniqueMethod: () => {\r\n        return \"String from mock\"\r\n      }\r\n    }\r\n\r\n    descriptor.writable = true\r\n    mocksToInject[type.name] = mockInstance\r\n\r\n    localMocksInjectedCllbk = (testClassObj) => {\r\n      testClassObj[property] = mockInstance\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport function Test(target, property, descriptor) {\r\n  if(typeof target[property] !== 'function')\r\n    throw new TypeError('A function was expected to test: ' + property)\r\n\r\n  descriptor.value.testMethod = true\r\n}\r\n\r\n\r\nexport function Before(target, property, descriptor) {\r\n  if(typeof target[property] !== 'function')\r\n    throw new TypeError('A function was expected to test: ' + property)\r\n\r\n  descriptor.value.beforeMethod = true\r\n}\r\n\r\n\r\nexport function InjectMocks(type) {\r\n  return (target, property, descriptor) => {\r\n    descriptor.writable = true\r\n\r\n    let metaInstance = ModuleContainer.getModuleContainer()[type.interfaceName]\r\n    let objToTest = metaInstance.impl\r\n\r\n    for(let classProp in metaInstance.dependencies) {\r\n      let dataType = metaInstance.dependencies[classProp]\r\n      objToTest[classProp] = mocksToInject[dataType]\r\n    }\r\n\r\n    injectMocksCllbk = (testClassObj) => {\r\n      testClassObj[property] = objToTest\r\n    }\r\n  }\r\n}"]}